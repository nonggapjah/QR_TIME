<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Attendance Links</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;margin:0;background:#f7f7f8;color:#111}
    .wrap{max-width:720px;margin:0 auto;padding:20px}
    .card{background:#fff;border:1px solid #e5e7eb;border-radius:16px;box-shadow:0 4px 16px rgba(0,0,0,.05);padding:18px}
    input{width:100%;max-width:560px;padding:10px 12px;border:1px solid #d1d5db;border-radius:12px}
    .row{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
    a,button{display:inline-block;padding:10px 14px;border-radius:12px;border:1px solid #d1d5db;background:#fff;color:#111;text-decoration:none}
    .primary{background:#111;color:#fff;border-color:#111}
    small{color:#6b7280}
    h2{margin:0 0 6px 0}
  </style>
</head>
<body>
<div class="wrap">
  <h2>หน้าเริ่มต้นระบบลงเวลา</h2>
  <p><small>ใส่ Apps Script Web App URL (ลงท้ายด้วย <code>/exec</code>) แล้วกดสร้างลิงก์</small></p>
  <div class="card">
    <input id="api" placeholder="เช่น https://script.google.com/macros/s/XXXX/exec">
    <div class="row">
      <button class="primary" onclick="make('scanner-qr.html','IN')">สแกนด้วยกล้อง (IN)</button>
      <button onclick="make('scanner-qr.html','OUT')">สแกนด้วยกล้อง (OUT)</button>
      <button onclick="make('self-check.html','IN')">Self-check (IN)</button>
      <button onclick="make('self-check.html','OUT')">Self-check (OUT)</button>
    </div>
    <div class="row" id="links"></div>
  </div>
  <p><small>หมายเหตุ: ถ้าเปิดที่ root URL ของเว็บ จำเป็นต้องมีไฟล์ชื่อ <code>index.html</code> นี้</small></p>
</div>
<script>
function make(page, action){
  const api = document.getElementById('api').value.trim();
  if(!api){ alert('กรุณาใส่ API URL (/exec) ก่อน'); return; }
  const url = page+'?action='+encodeURIComponent(action)+'&api='+encodeURIComponent(api);
  const a = document.createElement('a');
  a.href = url;
  a.textContent = page + ' ('+action+')';
  a.className = 'primary';
  a.target = '_blank';
  const links = document.getElementById('links');
  links.innerHTML = '';
  links.appendChild(a);
}
</script>
</body>
</html>
